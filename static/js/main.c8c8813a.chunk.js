(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{14:function(r,t,e){r.exports=e(21)},19:function(r,t,e){},20:function(r,t,e){},21:function(r,t,e){"use strict";e.r(t);var o,n,a,i,c=e(0),u=e.n(c),l=e(5),s=e.n(l),f=e(2),m=e(3),v=e(1),h=(e(19),String.raw),g=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]];function E(){var r=Object(c.useState)(0),t=Object(m.a)(r,2),e=t[0],l=t[1],s=Object(c.useState)(),g=Object(m.a)(s,2),E=g[0],T=g[1],P=Object(c.useState)(v.a.create()),C=Object(m.a)(P,2),w=C[0],L=C[1],_=Object(c.useRef)(null),y=Object(c.useRef)(null),U=Object(c.useRef)(null);Object(c.useEffect)((function(){var r,t=null===(r=U.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");_.current=function(r){var t=h(a||(a=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    attribute vec2 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * "," * ",";\n      "," = ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","aTextureCoords","uModelMatrix","uViewMatrix","uProjectionMatrix","vColor","vTextureCoords","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition","vColor","aColor","vTextureCoords","aTextureCoords"),e=h(i||(i=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Uniforms\n    uniform sampler2D ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * texture2D(",", ",");\n    }\n  "])),"vColor","vTextureCoords","uSampler","vColor","uSampler","vTextureCoords"),o=R(r,t,e);return{program:o,attribs:{position:r.getAttribLocation(o,"aPosition"),color:r.getAttribLocation(o,"aColor"),textureCoords:r.getAttribLocation(o,"aTextureCoords")},uniforms:{sampler:b(r,o,"uSampler"),modelMatrix:b(r,o,"uModelMatrix"),viewMatrix:b(r,o,"uViewMatrix"),projectionMatrix:b(r,o,"uProjectionMatrix")}}}(t),y.current=function(r){var t=h(o||(o=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec3 ",";\n    attribute vec4 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying lowp vec3 ",";\n    // Program\n    void main(void) {\n      // Apply lighting\n      highp vec3 ambientLightColor = vec3(0.3, 0.3, 0.3);\n      highp vec3 directionalLightColor = vec3(1, 1, 1);\n      highp vec3 directionalLightVector = vec3(0, 0, 1);\n      highp vec4 transformedNormal = "," * "," * vec4(",", 0);\n      highp float directionalLightIntensity = max(0.0, dot(directionalLightVector, transformedNormal.xyz));\n      "," = ambientLightColor + directionalLightIntensity * directionalLightColor;\n      "," = ",";\n      gl_Position = "," * "," * "," * ",";\n    }\n  "])),"aPosition","aNormal","aColor","uModelMatrix","uViewMatrix","uProjectionMatrix","vColor","vLighting","uViewMatrix","uModelMatrix","aNormal","vLighting","vColor","aColor","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition"),e=h(n||(n=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying lowp vec3 ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * vec4(",", 1.0);\n    }\n  "])),"vColor","vLighting","vColor","vLighting"),a=R(r,t,e);return{program:a,attribs:{position:r.getAttribLocation(a,"aPosition"),normal:r.getAttribLocation(a,"aNormal"),color:r.getAttribLocation(a,"aColor")},uniforms:{modelMatrix:b(r,a,"uModelMatrix"),viewMatrix:b(r,a,"uViewMatrix"),projectionMatrix:b(r,a,"uProjectionMatrix")}}}(t);for(var e=0,c=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3];e<c.length;e++){var u=c[e];d(t,u,"".concat("/mobius","/texture/hours").concat(u-t.TEXTURE0,".bmp"))}t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.clearColor(0,0,0,1),t.enable(t.CULL_FACE),t.cullFace(t.BACK);var s=requestAnimationFrame((function r(t){l(t/12e3*Math.PI),s=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(s)}}),[]),Object(c.useEffect)((function(){var r,t=null===(r=U.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");if(!_.current||!y.current)throw new Error("Missing shader program!");var o=_.current,n=o.program,a=o.attribs,i=o.uniforms,c=y.current,u=c.program,l=c.attribs,s=c.uniforms,f=v.a.perspective(v.a.create(),Math.PI/5,t.canvas.width/t.canvas.height,.1,100),m=v.a.fromTranslation(v.a.create(),[0,0,-4]);t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);for(var h=[],g=[],E=[],d=[],T=0;T<4;T++){var R=M(t,e,T);h[T]=R.vertexCount,g[T]=R.positions,E[T]=R.colors,d[T]=R.textureCoords}try{t.useProgram(n),t.uniformMatrix4fv(_.current.uniforms.modelMatrix,!1,w),t.uniformMatrix4fv(_.current.uniforms.viewMatrix,!1,m),t.uniformMatrix4fv(_.current.uniforms.projectionMatrix,!1,f);for(var b=0;b<4;b++){t.uniform1i(i.sampler,b),x(t,a.position,g[b],3,t.FLOAT),x(t,a.color,E[b],3,t.FLOAT),x(t,a.textureCoords,d[b],2,t.FLOAT);try{t.drawArrays(t.TRIANGLE_STRIP,0,h[b])}finally{p(t,a.textureCoords),p(t,a.color),p(t,a.position)}}}finally{[].concat(g,E,d).forEach((function(r){return t.deleteBuffer(r)}))}var P=function(r,e,o,n){var a=function(r,t,e,o){return{vertexCount:4,positions:A(r,[-e,-8*e,t,+e,-8*e,t,-e,o,t,+e,o,t]),normals:A(r,[0,0,1,0,0,1,0,0,1,0,0,1]),colors:A(r,[.75,.75,.75,.75,.75,.75,.75,.75,.75,.75,.75,.75])}}(t,r,e,o),i=a.vertexCount,c=a.positions,h=a.normals,g=a.colors;try{t.useProgram(u),t.uniformMatrix4fv(s.modelMatrix,!1,v.a.rotateZ(v.a.create(),w,-n)),t.uniformMatrix4fv(s.viewMatrix,!1,m),t.uniformMatrix4fv(s.projectionMatrix,!1,f),x(t,l.position,c,3,t.FLOAT),x(t,l.normal,h,3,t.FLOAT),x(t,l.color,g,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_STRIP,0,i)}finally{p(t,l.color),p(t,l.normal),p(t,l.position)}}finally{t.deleteBuffer(g),t.deleteBuffer(h),t.deleteBuffer(c)}};P(.01,.02,.6,e),P(.02,.02,.8,12*e);var C=function(r,t){for(var e=.05,o=.01,n=Math.sqrt(e*e+o*o),a=e/n,i=o/n,c=[0,0,t+o],u=[0,0,1],l=0;l<2*Math.PI;l+=Math.PI/30)c.push(e*Math.cos(l),e*Math.sin(l),t),u.push(i*Math.cos(l),i*Math.sin(l),a);var s=c.length/3;return{vertexCount:s,positions:A(r,c),normals:A(r,u),colors:A(r,new Array(3*s).fill(.75))}}(t,.03),L=C.vertexCount,F=C.positions,I=C.normals,O=C.colors;try{t.useProgram(u),t.uniformMatrix4fv(s.modelMatrix,!1,w),t.uniformMatrix4fv(s.viewMatrix,!1,m),t.uniformMatrix4fv(s.projectionMatrix,!1,f),x(t,l.position,F,3,t.FLOAT),x(t,l.normal,I,3,t.FLOAT),x(t,l.color,O,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_FAN,0,L)}finally{p(t,l.position),p(t,l.color)}}finally{t.deleteBuffer(O),t.deleteBuffer(F)}}),[e,w]);return u.a.createElement("div",{className:"App"},u.a.createElement("header",{className:"App-header"},u.a.createElement("canvas",{width:"768px",height:"768px",ref:U,onPointerDown:function(r){var t=r.currentTarget,e=r.pointerId,o=r.clientX,n=r.clientY;t.setPointerCapture(e),T({x:o,y:n})},onPointerMove:function(r){var t=r.clientX,e=r.clientY;if(E){var o=t-E.x,n=e-E.y,a=Math.sqrt(o*o+n*n);if(a>0){var i=v.a.fromRotation(v.a.create(),.01*a,[n,o,0]);L(v.a.mul(v.a.create(),i,w)),T({x:t,y:e})}}},onPointerUp:function(r){var t=r.currentTarget,e=r.pointerId;T(null),t.releasePointerCapture(e)}}),u.a.createElement("p",null,"M\xf6bius Clock")))}function d(r,t,e){var o=r.createTexture();r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));var n=new Image;return n.onload=function(){r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),T(n.width)&&T(n.height)?(r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},n.src=e,o}function T(r){return 0===(r&r-1)}function x(r,t,e,o,n){r.bindBuffer(r.ARRAY_BUFFER,e),r.vertexAttribPointer(t,o,n,!1,0,0),r.enableVertexAttribArray(t)}function p(r,t){r.disableVertexAttribArray(t)}function M(r,t,e){var o=function(r,t){for(var e=[],o=[],n=[],a=.1,i=0;i<1.001;i+=.033333){var c=(t+i)*Math.PI,u=1.5*(c-r),l=1-a*Math.cos(u),s=1+a*Math.cos(u);o.push(l*Math.sin(c),l*Math.cos(c),-a*Math.sin(u)),o.push(s*Math.sin(c),s*Math.cos(c),.1*Math.sin(u));for(var f=[0,0,0],m=0;m<3;m++)f[m]=(1-i)*g[t][m]+i*g[(t+1)%g.length][m];n.push.apply(n,f.concat(f)),e.push(i,0,i,1)}return{positions:o,colors:n,textureCoords:e}}(t,e),n=o.positions,a=o.colors,i=o.textureCoords;return{vertexCount:n.length/3,positions:A(r,n),colors:A(r,a),textureCoords:A(r,i)}}function A(r,t){var e=r.createBuffer();if(!e)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,e),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW),e}function R(r,t,e){var o=r.createProgram();if(!o)throw new Error("Failed to create program.");if(r.attachShader(o,P(r,r.VERTEX_SHADER,t)),r.attachShader(o,P(r,r.FRAGMENT_SHADER,e)),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS)){var n="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(o));throw r.deleteProgram(o),new Error(n)}return o}function b(r,t,e){return r.getUniformLocation(t,e)||function(r){throw new Error(r)}('No uniform named "'.concat(e,'" was found.'))}function P(r,t,e){var o=r.createShader(t);if(!o)throw new Error("Failed to create shader.");if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var n="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(o));throw r.deleteShader(o),new Error(n)}return o}e(20);s.a.render(u.a.createElement(E,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.c8c8813a.chunk.js.map