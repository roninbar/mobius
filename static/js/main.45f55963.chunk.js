(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{14:function(r,e,t){r.exports=t(21)},19:function(r,e,t){},20:function(r,e,t){},21:function(r,e,t){"use strict";t.r(e);var o,n,a,i,u=t(0),c=t.n(u),s=t(5),l=t.n(s),f=t(2),E=t(3),m=t(1),v=(t(19),function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),o=1;o<e;o++)t[o-1]=arguments[o];return r.slice(1).reduce((function(r,e,o){return r+t[o]+e}),r[0])}),T=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]];function d(){var r=Object(u.useState)(0),e=Object(E.a)(r,2),t=e[0],s=e[1],l=Object(u.useState)(),T=Object(E.a)(l,2),d=T[0],p=T[1],P=Object(u.useState)(m.a.fromTranslation(m.a.create(),[0,0,-4])),_=Object(E.a)(P,2),w=_[0],C=_[1],U=Object(u.useRef)(null),L=Object(u.useRef)(null),F=Object(u.useRef)(null);Object(u.useEffect)((function(){var r,e=null===(r=F.current)||void 0===r?void 0:r.getContext("webgl");if(!e)throw new Error("Failed to get a WebGL context.");U.current=function(r){var e=v(a||(a=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    attribute vec2 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * ",";\n      "," = ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","aTextureCoords","uModelViewMatrix","uProjectionMatrix","vColor","vTextureCoords","uProjectionMatrix","uModelViewMatrix","aPosition","vColor","aColor","vTextureCoords","aTextureCoords"),t=v(i||(i=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Uniforms\n    uniform sampler2D ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * texture2D(",", ",");\n    }\n  "])),"vColor","vTextureCoords","uSampler","vColor","uSampler","vTextureCoords"),o=R(r,e,t);return{program:o,attribs:{position:r.getAttribLocation(o,"aPosition"),color:r.getAttribLocation(o,"aColor"),textureCoords:r.getAttribLocation(o,"aTextureCoords")},uniforms:{sampler:b(r,o,"uSampler"),modelViewMatrix:b(r,o,"uModelViewMatrix"),projectionMatrix:b(r,o,"uProjectionMatrix")}}}(e),L.current=function(r){var e=v(o||(o=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","uModelViewMatrix","uProjectionMatrix","vColor","uProjectionMatrix","uModelViewMatrix","aPosition","vColor","aColor"),t=v(n||(n=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    // Program\n    void main(void) {\n      gl_FragColor = ",";\n    }\n  "])),"vColor","vColor"),a=R(r,e,t);return{program:a,attribs:{position:r.getAttribLocation(a,"aPosition"),color:r.getAttribLocation(a,"aColor")},uniforms:{modelViewMatrix:b(r,a,"uModelViewMatrix"),projectionMatrix:b(r,a,"uProjectionMatrix")}}}(e);for(var t=0,u=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3];t<u.length;t++){var c=u[t];x(e,c,"".concat("/mobius","/texture/hours").concat(c-e.TEXTURE0,".bmp"))}e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearDepth(1),e.clearColor(0,0,0,1),e.enable(e.CULL_FACE),e.cullFace(e.BACK);var l=requestAnimationFrame((function r(e){s(e/12e3*Math.PI),l=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(l)}}),[]),Object(u.useEffect)((function(){var r,e=null===(r=F.current)||void 0===r?void 0:r.getContext("webgl");if(!e)throw new Error("Failed to get a WebGL context.");if(!U.current||!L.current)throw new Error("Missing shader program!");var o=U.current,n=o.program,a=o.attribs,i=o.uniforms,u=L.current,c=u.program,s=u.attribs,l=u.uniforms,f=m.a.perspective(m.a.create(),Math.PI/5,e.canvas.width/e.canvas.height,.1,100);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);for(var E=[],v=[],T=[],d=[],x=0;x<4;x++){var p=A(e,t,x);E[x]=p.vertexCount,v[x]=p.positions,T[x]=p.colors,d[x]=p.textureCoords}try{e.useProgram(n),e.uniformMatrix4fv(U.current.uniforms.modelViewMatrix,!1,w),e.uniformMatrix4fv(U.current.uniforms.projectionMatrix,!1,f);for(var R=0;R<4;R++){e.uniform1i(i.sampler,R),h(e,a.position,v[R],3,e.FLOAT),h(e,a.color,T[R],3,e.FLOAT),h(e,a.textureCoords,d[R],2,e.FLOAT);try{e.drawArrays(e.TRIANGLE_STRIP,0,E[R])}finally{g(e,a.textureCoords),g(e,a.color),g(e,a.position)}}}finally{[].concat(v,T,d).forEach((function(r){return e.deleteBuffer(r)}))}var b=function(r,t,o){var n=function(r,e,t){return{vertexCount:4,positions:M(r,[-e,0,0,+e,0,0,-e,t,0,+e,t,0]),colors:M(r,[.75,.75,.75,.75,.75,.75,.75,.75,.75,.75,.75,.75])}}(e,r,t),a=n.vertexCount,i=n.positions,u=n.colors;try{e.useProgram(c),e.uniformMatrix4fv(l.modelViewMatrix,!1,m.a.rotateZ(m.a.create(),w,-o)),e.uniformMatrix4fv(l.projectionMatrix,!1,f),h(e,s.position,i,3,e.FLOAT),h(e,s.color,u,3,e.FLOAT);try{e.drawArrays(e.TRIANGLE_STRIP,0,a)}finally{g(e,s.color),g(e,s.position)}}finally{e.deleteBuffer(u),e.deleteBuffer(i)}};b(.02,.6,t),b(.02,.8,12*t);var P=function(r){for(var e=[0,0,.01],t=0;t<2*Math.PI;t+=Math.PI/30)e.push(.05*Math.cos(t),.05*Math.sin(t),0);var o=e.length/3;return{vertexCount:o,positions:M(r,e),colors:M(r,new Array(3*o).fill(.75))}}(e),_=P.vertexCount,C=P.positions,I=P.colors;try{e.useProgram(c),e.uniformMatrix4fv(l.modelViewMatrix,!1,w),e.uniformMatrix4fv(l.projectionMatrix,!1,f),h(e,s.position,C,3,e.FLOAT),h(e,s.color,I,3,e.FLOAT);try{e.drawArrays(e.TRIANGLE_FAN,0,_)}finally{g(e,s.position),g(e,s.color)}}finally{e.deleteBuffer(I),e.deleteBuffer(C)}}),[t,w]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("canvas",{width:"768px",height:"768px",ref:F,onPointerDown:function(r){var e=r.target,t=r.pointerId,o=r.clientX,n=r.clientY;e instanceof Element&&e.setPointerCapture(t),p({x:o,y:n})},onPointerMove:function(r){var e=r.clientX,t=r.clientY;if(d){var o=e-d.x,n=t-d.y,a=Math.sqrt(o*o+n*n);a>0&&(C(m.a.rotate(m.a.create(),w,.01*a,[n,o,0])),p({x:e,y:t}))}},onPointerUp:function(r){var e=r.target,t=r.pointerId;p(null),e instanceof Element&&e.releasePointerCapture(t)}}),c.a.createElement("p",null,"M\xf6bius Clock")))}function x(r,e,t){var o=r.createTexture();r.activeTexture(e),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));var n=new Image;return n.onload=function(){r.activeTexture(e),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n),p(n.width)&&p(n.height)?(r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},n.src=t,o}function p(r){return 0===(r&r-1)}function h(r,e,t,o,n){r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(e,o,n,!1,0,0),r.enableVertexAttribArray(e)}function g(r,e){r.disableVertexAttribArray(e)}function A(r,e,t){var o=function(r,e){for(var t=[],o=[],n=[],a=.1,i=0;i<1.001;i+=.033333){var u=(e+i)*Math.PI,c=1.5*(u-r),s=1-a*Math.cos(c),l=1+a*Math.cos(c);o.push(s*Math.sin(u),s*Math.cos(u),-a*Math.sin(c)),o.push(l*Math.sin(u),l*Math.cos(u),.1*Math.sin(c));for(var f=[0,0,0],E=0;E<3;E++)f[E]=(1-i)*T[e][E]+i*T[(e+1)%T.length][E];n.push.apply(n,f.concat(f)),t.push(i,0,i,1)}return{positions:o,colors:n,textureCoords:t}}(e,t),n=o.positions,a=o.colors,i=o.textureCoords;return{vertexCount:n.length/3,positions:M(r,n),colors:M(r,a),textureCoords:M(r,i)}}function M(r,e){var t=r.createBuffer();if(!t)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e),r.STATIC_DRAW),t}function R(r,e,t){var o=r.createProgram();if(!o)throw new Error("Failed to create program.");if(r.attachShader(o,P(r,r.VERTEX_SHADER,e)),r.attachShader(o,P(r,r.FRAGMENT_SHADER,t)),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS)){var n="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(o));throw r.deleteProgram(o),new Error(n)}return o}function b(r,e,t){return r.getUniformLocation(e,t)||function(r){throw new Error(r)}('No uniform named "'.concat(t,'" was found.'))}function P(r,e,t){var o=r.createShader(e);if(!o)throw new Error("Failed to create shader.");if(r.shaderSource(o,t),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var n="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(o));throw r.deleteShader(o),new Error(n)}return o}t(20);l.a.render(c.a.createElement(d,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.45f55963.chunk.js.map