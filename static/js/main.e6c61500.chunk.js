(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{16:function(r,t,e){r.exports=e(23)},21:function(r,t,e){},22:function(r,t,e){},23:function(r,t,e){"use strict";e.r(t);var o,a,n,i,u=e(1),c=e.n(u),s=e(6),l=e.n(s),f=e(2),h=e(7),m=e(4),p=e(0),v=(e(21),String.raw),M=[0,0,0],d=[1,.8,.5],T=[.75,.75,.75],x=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]],g=.1,E=Math.PI/36;function A(){var r=Object(u.useState)(0),t=Object(m.a)(r,2),e=t[0],s=t[1],l=Object(u.useState)(),h=Object(m.a)(l,2),M=h[0],d=h[1],x=Object(u.useState)(p.a.create()),E=Object(m.a)(x,2),A=E[0],R=E[1],U=Object(u.useRef)(null),N=Object(u.useRef)(null),S=Object(u.useRef)(null);Object(u.useEffect)((function(){var r,t=null===(r=S.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");U.current=function(r){var t=v(n||(n=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    attribute vec2 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * "," * ",";\n      "," = ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","aTextureCoords","uModelMatrix","uViewMatrix","uProjectionMatrix","vColor","vTextureCoords","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition","vColor","aColor","vTextureCoords","aTextureCoords"),e=v(i||(i=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Uniforms\n    uniform sampler2D ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * texture2D(",", ",");\n    }\n  "])),"vColor","vTextureCoords","uSampler","vColor","uSampler","vTextureCoords"),o=F(r,t,e);return{program:o,attribs:{position:r.getAttribLocation(o,"aPosition"),color:r.getAttribLocation(o,"aColor"),textureCoords:r.getAttribLocation(o,"aTextureCoords")},uniforms:{sampler:O(r,o,"uSampler"),modelMatrix:O(r,o,"uModelMatrix"),viewMatrix:O(r,o,"uViewMatrix"),projectionMatrix:O(r,o,"uProjectionMatrix")}}}(t),N.current=function(r){var t=v(o||(o=Object(f.a)(["\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Attributes\n    attribute vec4 ",";\n    attribute vec3 ",";\n    attribute vec4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying lowp vec3 ",";\n    // Program\n    void main(void) {\n      // Apply lighting\n      highp vec3 ambientLightColor = vec3(0.3, 0.3, 0.3);\n      highp vec3 directionalLightColor = vec3(1, 1, 1);\n      highp vec3 directionalLightVector = normalize(vec3(0.85, 0.8, 0.75));\n      highp vec4 transformedNormal = normalize("," * "," * vec4(",", 0));\n      highp float directionalLightIntensity = max(0.0, dot(directionalLightVector, transformedNormal.xyz));\n      "," = ambientLightColor + directionalLightIntensity * directionalLightColor;\n      "," = ",";\n      gl_Position = "," * "," * "," * ",";\n    }\n  "])),"uModelMatrix","uViewMatrix","uProjectionMatrix","aPosition","aNormal","aColor","vColor","vLighting","uViewMatrix","uModelMatrix","aNormal","vLighting","vColor","aColor","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition"),e=v(a||(a=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying lowp vec3 ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * vec4(",", 1.0);\n    }\n  "])),"vColor","vLighting","vColor","vLighting"),n=F(r,t,e);return{program:n,attribs:{position:r.getAttribLocation(n,"aPosition"),normal:r.getAttribLocation(n,"aNormal"),color:r.getAttribLocation(n,"aColor")},uniforms:{modelMatrix:O(r,n,"uModelMatrix"),viewMatrix:O(r,n,"uViewMatrix"),projectionMatrix:O(r,n,"uProjectionMatrix")}}}(t);for(var e=0,u=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3];e<u.length;e++){var c=u[e];P(t,c,"".concat("/mobius","/texture/hours").concat(c-t.TEXTURE0,".bmp"))}t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.clearColor(0,0,0,1),t.enable(t.CULL_FACE),t.cullFace(t.BACK);var l=requestAnimationFrame((function r(t){s(t/12e3*Math.PI),l=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(l)}}),[]),Object(u.useEffect)((function(){var r,t=null===(r=S.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");if(!U.current||!N.current)throw new Error("Missing shader program!");var o=U.current,a=o.program,n=o.attribs,i=o.uniforms,u=N.current,c=u.program,s=u.attribs,l=u.uniforms,f=p.a.perspective(p.a.create(),Math.PI/5,t.canvas.width/t.canvas.height,.1,100),h=p.a.fromTranslation(p.a.create(),[0,0,-4]),m=function(r){var e=r(t),o=e.topology,a=e.positionBuffer,n=e.normalBuffer,i=e.colorBuffer;try{t.useProgram(c),_(t,o,s.position,a,s.normal,n,s.color,i)}finally{t.deleteBuffer(i),t.deleteBuffer(n),t.deleteBuffer(a)}};t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.cullFace(t.FRONT),t.uniformMatrix4fv(l.modelMatrix,!1,p.a.scale(p.a.create(),A,[1.2,1.2,1])),t.uniformMatrix4fv(l.viewMatrix,!1,h),t.uniformMatrix4fv(l.projectionMatrix,!1,f);var v=b(t),M=v.topology,d=v.positionBuffer,x=v.normalBuffer,E=v.colorBuffer;try{t.useProgram(c),_(t,M,s.position,d,s.normal,x,s.color,E)}finally{t.deleteBuffer(E),t.deleteBuffer(x),t.deleteBuffer(E)}t.cullFace(t.BACK),t.uniformMatrix4fv(l.modelMatrix,!1,p.a.scale(p.a.create(),p.a.translate(p.a.create(),A,[0,0,-g]),[1.199,1.199,1])),m(L);for(var P=[],R=[],F=[],O=[],j=0;j<4;j++){var D=I(t,e,j);P[j]=D.vertexCount,R[j]=D.positions,F[j]=D.colors,O[j]=D.textureCoords}try{t.useProgram(a),t.uniformMatrix4fv(U.current.uniforms.modelMatrix,!1,A),t.uniformMatrix4fv(U.current.uniforms.viewMatrix,!1,h),t.uniformMatrix4fv(U.current.uniforms.projectionMatrix,!1,f);for(var X=0;X<4;X++){t.uniform1i(i.sampler,X),w(t,n.position,R[X],3,t.FLOAT),w(t,n.color,F[X],3,t.FLOAT),w(t,n.textureCoords,O[X],2,t.FLOAT);try{t.cullFace(t.BACK),t.drawArrays(t.TRIANGLE_STRIP,0,P[X])}finally{B(t,n.textureCoords),B(t,n.color),B(t,n.position)}}}finally{[].concat(R,F,O).forEach((function(r){return t.deleteBuffer(r)}))}var G=function(r,e,o,a){var n=function(r,t,e,o){return{vertexCount:4,positions:C(r,[-e,-.2*o,t,+e,-.2*o,t,-e,o,t,+e,o,t]),normals:C(r,[0,0,1,0,0,1,0,0,1,0,0,1]),colors:C(r,[].concat(T,T,T,T))}}(t,r,e,o),i=n.vertexCount,u=n.positions,m=n.normals,v=n.colors;try{t.useProgram(c),t.uniformMatrix4fv(l.modelMatrix,!1,p.a.rotateZ(p.a.create(),A,-a)),t.uniformMatrix4fv(l.viewMatrix,!1,h),t.uniformMatrix4fv(l.projectionMatrix,!1,f),w(t,s.position,u,3,t.FLOAT),w(t,s.normal,m,3,t.FLOAT),w(t,s.color,v,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_STRIP,0,i)}finally{B(t,s.color),B(t,s.normal),B(t,s.position)}}finally{t.deleteBuffer(v),t.deleteBuffer(m),t.deleteBuffer(u)}};G(.01,.02,.6,e),G(.02,.02,.8,12*e);var V=function(r,t){for(var e=.05,o=.01,a=Math.sqrt(e*e+o*o),n=e/a,i=o/a,u=[0,0,t+o],c=[0,0,1],s=[].concat(T),l=0;l<2*Math.PI;l+=Math.PI/30)u.push(e*Math.cos(l),e*Math.sin(l),t),c.push(i*Math.cos(l),i*Math.sin(l),n),s.push.apply(s,T);return{vertexCount:u.length/3,positions:C(r,u),normals:C(r,c),colors:C(r,s)}}(t,.03),Y=V.vertexCount,W=V.positions,k=V.normals,q=V.colors;try{t.useProgram(c),t.uniformMatrix4fv(l.modelMatrix,!1,A),t.uniformMatrix4fv(l.viewMatrix,!1,h),t.uniformMatrix4fv(l.projectionMatrix,!1,f),w(t,s.position,W,3,t.FLOAT),w(t,s.normal,k,3,t.FLOAT),w(t,s.color,q,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_FAN,0,Y)}finally{B(t,s.position),B(t,s.color)}}finally{t.deleteBuffer(q),t.deleteBuffer(W)}var z=p.a.copy(p.a.create(),A);p.a.translate(z,z,[0,0,-g]),p.a.rotateY(z,z,Math.PI),p.a.scale(z,z,[1.2,1.2,.24]),t.uniformMatrix4fv(l.modelMatrix,!1,z),m(y),t.uniformMatrix4fv(l.modelMatrix,!1,p.a.scale(p.a.create(),A,[1.2,1.2,1])),m(b)}),[e,A]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("canvas",{width:"768px",height:"768px",ref:S,onPointerDown:function(r){var t=r.currentTarget,e=r.pointerId,o=r.clientX,a=r.clientY;t.setPointerCapture(e),d({x:o,y:a})},onPointerMove:function(r){var t=r.clientX,e=r.clientY;if(M){var o=t-M.x,a=e-M.y,n=Math.sqrt(o*o+a*a);if(n>0){var i=p.a.fromRotation(p.a.create(),.01*n,[a,o,0]);R(p.a.mul(p.a.create(),i,A)),d({x:t,y:e})}}},onPointerUp:function(r){var t=r.currentTarget,e=r.pointerId;d(null),t.releasePointerCapture(e)}}),c.a.createElement("p",null,"M\xf6bius Clock")))}function P(r,t,e){var o=r.createTexture();r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));var a=new Image;return a.onload=function(){r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,a),R(a.width)&&R(a.height)?(r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},a.src=e,o}function R(r){return 0===(r&r-1)}function y(r){for(var t=[],e=[0,0,1],o=[0,0,1],a=[].concat(d),n=0,i=1,u=1*Math.sin(E),c=1*Math.cos(E),s=-Math.PI;s<Math.PI+.001;s+=E,i++){var l=u*Math.cos(s),f=u*Math.sin(s);e.push(l,f,c),o.push(l,f,c),a.push.apply(a,d)}t.push({mode:r.TRIANGLE_FAN,first:n,count:i-n}),n=i;for(var h=E;h<.5*Math.PI-.001;h+=E){for(var m=1*Math.sin(h),p=1*Math.sin(h+E),v=1*Math.cos(h),M=1*Math.cos(h+E),T=-Math.PI;T<Math.PI+.001;T+=E,i+=2){var x=m*Math.cos(T),g=p*Math.cos(T),A=m*Math.sin(T),P=p*Math.sin(T);e.push(x,A,v),o.push(x,A,v),a.push.apply(a,d),e.push(g,P,M),o.push(g,P,M),a.push.apply(a,d)}t.push({mode:r.TRIANGLE_STRIP,first:n,count:i-n}),n=i}return{topology:t,positionBuffer:C(r,e),normalBuffer:C(r,o),colorBuffer:C(r,a)}}function b(r){for(var t=[],e=[],o=[],a=[],n=0;n<2*Math.PI+.001;n+=E)e.push(1*Math.cos(n),1*Math.sin(n),.1),o.push(Math.cos(n),Math.sin(n),0),a.push.apply(a,d),e.push(1*Math.cos(n),1*Math.sin(n),-g),o.push(Math.cos(n),Math.sin(n),0),a.push.apply(a,d);return t.push({mode:r.TRIANGLE_STRIP,first:0,count:e.length/3}),{topology:t,positionBuffer:C(r,e),normalBuffer:C(r,o),colorBuffer:C(r,a)}}function L(r){for(var t=[],e=[0,0,0],o=[].concat(M),a=[0,0,1],n=[0,0],i=0,u=1,c=0;c<2*Math.PI+.001;c+=Math.PI/36,u++){var s=1/6*Math.cos(c),l=1/6*Math.sin(c);e.push(s,l,0),a.push(0,0,1),o.push.apply(o,M),n.push(s/1,l/1)}t.push({mode:r.TRIANGLE_FAN,first:i,count:u-i}),i=u;for(var f=1/6;f<.999;f+=1/6){for(var h=0;h<2*Math.PI+.001;h+=Math.PI/36,u+=2){var m=f*Math.cos(h),p=f*Math.sin(h);e.push(m,p,0),a.push(0,0,1),o.push.apply(o,M),n.push(m/1,p/1);var v=(f+1/6)*Math.cos(h),d=(f+1/6)*Math.sin(h);e.push(v,d,0),a.push(0,0,1),o.push.apply(o,M),n.push(v/1,d/1)}t.push({mode:r.TRIANGLE_STRIP,first:i,count:u-i}),i=u}return{topology:t,positionBuffer:C(r,e),normalBuffer:C(r,a),colorBuffer:C(r,o),textureCoordBuffer:C(r,n)}}function I(r,t,e){var o=function(r,t){for(var e=[],o=[],a=[],n=0;n<1.001;n+=.033333){var i=(t+n)*Math.PI,u=1.5*(i-r),c=1+g*Math.cos(u),s=1-g*Math.cos(u);o.push(c*Math.sin(i),c*Math.cos(i),-g*Math.sin(u)),o.push(s*Math.sin(i),s*Math.cos(i),.1*Math.sin(u));for(var l=[0,0,0],f=0;f<3;f++)l[f]=(1-n)*x[t][f]+n*x[(t+1)%x.length][f];a.push.apply(a,l.concat(l)),e.push(n,0,n,1)}return{positions:o,colors:a,textureCoords:e}}(t,e),a=o.positions,n=o.colors,i=o.textureCoords;return{vertexCount:a.length/3,positions:C(r,a),colors:C(r,n),textureCoords:C(r,i)}}function C(r,t){var e=r.createBuffer();if(!e)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,e),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW),e}function _(r,t,e,o,a,n,i,u){w(r,e,o,3,r.FLOAT),w(r,a,n,3,r.FLOAT),w(r,i,u,3,r.FLOAT);try{var c,s=Object(h.a)(t);try{for(s.s();!(c=s.n()).done;){var l=c.value,f=l.mode,m=l.first,p=l.count;r.drawArrays(f,m,p)}}catch(v){s.e(v)}finally{s.f()}}finally{B(r,i),B(r,a),B(r,e)}}function w(r,t,e,o,a){r.bindBuffer(r.ARRAY_BUFFER,e),r.vertexAttribPointer(t,o,a,!1,0,0),r.enableVertexAttribArray(t)}function B(r,t){r.disableVertexAttribArray(t)}function F(r,t,e){var o=r.createProgram();if(!o)throw new Error("Failed to create program.");if(r.attachShader(o,U(r,r.VERTEX_SHADER,t)),r.attachShader(o,U(r,r.FRAGMENT_SHADER,e)),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS)){var a="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(o));throw r.deleteProgram(o),new Error(a)}return o}function U(r,t,e){var o=r.createShader(t);if(!o)throw new Error("Failed to create shader.");if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var a="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(o));throw r.deleteShader(o),new Error(a)}return o}function O(r,t,e){return r.getUniformLocation(t,e)||function(r){throw new Error(r)}('No uniform named "'.concat(e,'" was found.'))}e(22);l.a.render(c.a.createElement(A,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.e6c61500.chunk.js.map