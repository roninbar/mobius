(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{16:function(r,t,e){r.exports=e(23)},21:function(r,t,e){},22:function(r,t,e){},23:function(r,t,e){"use strict";e.r(t);var a,o,n,i,u=e(1),c=e.n(u),l=e(6),s=e.n(l),f=e(2),m=e(7),h=e(4),v=e(0),M=(e(21),String.raw),p=[1,.8,.5],x=[.75,.75,.75],d=[.125,.125,.125],T=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]],E=.1,g=Math.PI/36;function A(){var r=Object(u.useState)(0),t=Object(h.a)(r,2),e=t[0],l=t[1],s=Object(u.useState)(),p=Object(h.a)(s,2),d=p[0],T=p[1],g=Object(u.useState)(v.a.create()),A=Object(h.a)(g,2),P=A[0],B=A[1],N=Object(u.useRef)(null),O=Object(u.useRef)(null),D=Object(u.useRef)(null);Object(u.useEffect)((function(){var r,t=null===(r=D.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");N.current=function(r){var t=M(n||(n=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    attribute vec2 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * "," * ",";\n      "," = ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","aTextureCoords","uModelMatrix","uViewMatrix","uProjectionMatrix","vColor","vTextureCoords","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition","vColor","aColor","vTextureCoords","aTextureCoords"),e=M(i||(i=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Uniforms\n    uniform sampler2D ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * texture2D(",", ",");\n    }\n  "])),"vColor","vTextureCoords","uSampler","vColor","uSampler","vTextureCoords"),a=L(r,t,e);return{program:a,attribs:{position:r.getAttribLocation(a,"aPosition"),color:r.getAttribLocation(a,"aColor"),textureCoords:r.getAttribLocation(a,"aTextureCoords")},uniforms:{sampler:U(r,a,"uSampler"),modelMatrix:U(r,a,"uModelMatrix"),viewMatrix:U(r,a,"uViewMatrix"),projectionMatrix:U(r,a,"uProjectionMatrix")}}}(t),O.current=function(r){var t=M(a||(a=Object(f.a)(["\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Attributes\n    attribute vec4 ",";\n    attribute vec3 ",";\n    attribute vec4 ",";\n    // Varyings\n    varying highp vec4 ",";\n    varying lowp vec4 ",";\n    // Program\n    void main(void) {\n      "," = normalize("," * "," * vec4(",", 0));\n      "," = ",";\n      gl_Position = "," * "," * "," * ",";\n    }\n  "])),"uModelMatrix","uNormalMatrix","uViewMatrix","uProjectionMatrix","aPosition","aNormal","aColor","vNormal","vColor","vNormal","uViewMatrix","uNormalMatrix","aNormal","vColor","aColor","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition"),e=M(o||(o=Object(f.a)(["\n    // Varyings\n    varying highp vec4 ",";\n    varying lowp vec4 ",";\n    // Program\n    void main(void) {\n      // Apply lighting\n      lowp vec3 Ca = vec3(0.3, 0.3, 0.3); // Ambient light color\n      lowp vec3 Cd = vec3(1, 1, 1); // Diffuse light color (white)\n      highp vec3 u = normalize(vec3(0.85, 0.8, 0.75)); // Diffuse light direction\n      lowp float Id = max(0.0, (gl_FrontFacing ? +1.0 : -1.0) * dot(u, ",".xyz)); // Diffuse intensity\n      lowp vec4 C = vec4(Ca + Id * Cd, 1.0); // Total incident light color\n      gl_FragColor = "," * C;\n    }\n  "])),"vNormal","vColor","vNormal","vColor"),n=L(r,t,e);return{program:n,attribs:{position:r.getAttribLocation(n,"aPosition"),normal:r.getAttribLocation(n,"aNormal"),color:r.getAttribLocation(n,"aColor")},uniforms:{normalMatrix:U(r,n,"uNormalMatrix"),modelMatrix:U(r,n,"uModelMatrix"),viewMatrix:U(r,n,"uViewMatrix"),projectionMatrix:U(r,n,"uProjectionMatrix")}}}(t);for(var e=0,u=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3];e<u.length;e++){var c=u[e];R(t,c,"".concat("/mobius","/texture/hours").concat(c-t.TEXTURE0,".bmp"))}t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.clearColor(0,0,0,1),t.enable(t.CULL_FACE),t.cullFace(t.BACK);var s=requestAnimationFrame((function r(t){l(t/12e3*Math.PI),s=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(s)}}),[]),Object(u.useEffect)((function(){var r,t=null===(r=D.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");if(!N.current||!O.current)throw new Error("Missing shader program!");var a=N.current,o=a.program,n=a.attribs,i=a.uniforms,u=O.current,c=u.program,l=u.attribs,s=u.uniforms,f=v.a.perspective(v.a.create(),Math.PI/5,t.canvas.width/t.canvas.height,.1,100),h=v.a.fromTranslation(v.a.create(),[0,0,-4]);t.uniformMatrix4fv(s.projectionMatrix,!1,f),t.uniformMatrix4fv(s.viewMatrix,!1,h);var M=function(r){var e=r(t),a=e.topology,o=e.positionBuffer,n=e.normalBuffer,i=e.colorBuffer;try{t.useProgram(c),function(r,t,e,a,o,n,i,u){I(r,e,a,3,r.FLOAT),I(r,o,n,3,r.FLOAT),I(r,i,u,3,r.FLOAT);try{var c,l=Object(m.a)(t);try{for(l.s();!(c=l.n()).done;){var s=c.value,f=s.mode,h=s.first,v=s.count;r.drawArrays(f,h,v)}}catch(M){l.e(M)}finally{l.f()}}finally{F(r,i),F(r,o),F(r,e)}}(t,a,l.position,o,l.normal,n,l.color,i)}finally{t.deleteBuffer(i),t.deleteBuffer(n),t.deleteBuffer(o)}};t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.cullFace(t.FRONT),t.uniformMatrix4fv(s.modelMatrix,!1,v.a.scale(v.a.create(),P,[1.2,1.2,1])),t.uniformMatrix4fv(s.normalMatrix,!1,v.a.scale(v.a.create(),P,[1/1.2,1/1.2,1])),M(C),t.cullFace(t.BACK);var p=v.a.translate(v.a.create(),P,[0,0,-E]);t.uniformMatrix4fv(s.modelMatrix,!1,v.a.scale(v.a.create(),p,[1.199,1.199,1])),t.uniformMatrix4fv(s.normalMatrix,!1,v.a.scale(v.a.create(),p,[1/1.2,1/1.2,1])),M(y);for(var d=[],T=[],g=[],A=[],R=0;R<4;R++){var L=_(t,e,R);d[R]=L.vertexCount,T[R]=L.positions,g[R]=L.colors,A[R]=L.textureCoords}try{t.useProgram(o),t.uniformMatrix4fv(i.modelMatrix,!1,P),t.uniformMatrix4fv(i.viewMatrix,!1,h),t.uniformMatrix4fv(i.projectionMatrix,!1,f);for(var B=0;B<4;B++){t.uniform1i(i.sampler,B),I(t,n.position,T[B],3,t.FLOAT),I(t,n.color,g[B],3,t.FLOAT),I(t,n.textureCoords,A[B],2,t.FLOAT);try{t.cullFace(t.BACK),t.drawArrays(t.TRIANGLE_STRIP,0,d[B])}finally{F(t,n.textureCoords),F(t,n.color),F(t,n.position)}}}finally{[].concat(T,g,A).forEach((function(r){return t.deleteBuffer(r)}))}var U=function(r,e,a,o){var n=function(r,t,e,a){return{vertexCount:4,positions:w(r,[-e,-.2*a,t,+e,-.2*a,t,-e,a,t,+e,a,t]),normals:w(r,[0,0,1,0,0,1,0,0,1,0,0,1]),colors:w(r,[].concat(x,x,x,x))}}(t,r,e,a),i=n.vertexCount,u=n.positions,f=n.normals,m=n.colors;try{t.useProgram(c);var h=v.a.rotateZ(v.a.create(),P,-o);t.uniformMatrix4fv(s.modelMatrix,!1,h),t.uniformMatrix4fv(s.normalMatrix,!1,h),I(t,l.position,u,3,t.FLOAT),I(t,l.normal,f,3,t.FLOAT),I(t,l.color,m,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_STRIP,0,i)}finally{F(t,l.color),F(t,l.normal),F(t,l.position)}}finally{t.deleteBuffer(m),t.deleteBuffer(f),t.deleteBuffer(u)}};U(.01,.02,.6,e),U(.02,.02,.8,12*e);var S=function(r,t){for(var e=.05,a=.01,o=Math.sqrt(e*e+a*a),n=e/o,i=a/o,u=[0,0,t+a],c=[0,0,1],l=[].concat(x),s=0;s<2*Math.PI;s+=Math.PI/30)u.push(e*Math.cos(s),e*Math.sin(s),t),c.push(i*Math.cos(s),i*Math.sin(s),n),l.push.apply(l,x);return{vertexCount:u.length/3,positions:w(r,u),normals:w(r,c),colors:w(r,l)}}(t,.03),j=S.vertexCount,X=S.positions,G=S.normals,V=S.colors;try{t.useProgram(c),t.uniformMatrix4fv(s.modelMatrix,!1,P),t.uniformMatrix4fv(s.normalMatrix,!1,P),I(t,l.position,X,3,t.FLOAT),I(t,l.normal,G,3,t.FLOAT),I(t,l.color,V,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_FAN,0,j)}finally{F(t,l.position),F(t,l.color)}}finally{t.deleteBuffer(V),t.deleteBuffer(X)}var Y=v.a.copy(v.a.create(),P);v.a.translate(Y,Y,[0,0,-E]),v.a.rotateX(Y,Y,Math.PI),t.uniformMatrix4fv(s.modelMatrix,!1,v.a.scale(v.a.create(),Y,[1.2,1.2,.24])),t.uniformMatrix4fv(s.normalMatrix,!1,v.a.scale(v.a.create(),Y,[1/1.2,1/1.2,1/.24])),M(b),t.uniformMatrix4fv(s.modelMatrix,!1,v.a.scale(v.a.create(),P,[1.2,1.2,1])),t.uniformMatrix4fv(s.normalMatrix,!1,v.a.scale(v.a.create(),P,[1/1.2,1/1.2,1])),M(C)}),[e,P]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("canvas",{width:"768px",height:"768px",ref:D,onPointerDown:function(r){var t=r.currentTarget,e=r.pointerId,a=r.clientX,o=r.clientY;t.setPointerCapture(e),T({x:a,y:o})},onPointerMove:function(r){var t=r.clientX,e=r.clientY;if(d){var a=t-d.x,o=e-d.y,n=Math.sqrt(a*a+o*o);if(n>0){var i=v.a.fromRotation(v.a.create(),.01*n,[o,a,0]);B(v.a.mul(v.a.create(),i,P)),T({x:t,y:e})}}},onPointerUp:function(r){var t=r.currentTarget,e=r.pointerId;T(null),t.releasePointerCapture(e)}}),c.a.createElement("p",null,"M\xf6bius Clock")))}function R(r,t,e){var a=r.createTexture();r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));var o=new Image;return o.onload=function(){r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,o),P(o.width)&&P(o.height)?(r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},o.src=e,a}function P(r){return 0===(r&r-1)}function b(r){for(var t=[],e=[0,0,1],a=[0,0,1],o=[].concat(p),n=0,i=1,u=1*Math.sin(g),c=1*Math.cos(g),l=-Math.PI;l<Math.PI+.001;l+=g,i++){var s=u*Math.cos(l),f=u*Math.sin(l);e.push(s,f,c),a.push(s,f,c),o.push.apply(o,p)}t.push({mode:r.TRIANGLE_FAN,first:n,count:i-n}),n=i;for(var m=g;m<.5*Math.PI-.001;m+=g){for(var h=1*Math.sin(m),v=1*Math.sin(m+g),M=1*Math.cos(m),x=1*Math.cos(m+g),d=-Math.PI;d<Math.PI+.001;d+=g,i+=2){var T=h*Math.cos(d),E=v*Math.cos(d),A=h*Math.sin(d),R=v*Math.sin(d);e.push(T,A,M),a.push(T,A,M),o.push.apply(o,p),e.push(E,R,x),a.push(E,R,x),o.push.apply(o,p)}t.push({mode:r.TRIANGLE_STRIP,first:n,count:i-n}),n=i}return{topology:t,positionBuffer:w(r,e),normalBuffer:w(r,a),colorBuffer:w(r,o)}}function C(r){for(var t=[],e=[],a=[],o=[],n=0;n<2*Math.PI+.001;n+=g)e.push(1*Math.cos(n),1*Math.sin(n),.1),a.push(Math.cos(n),Math.sin(n),0),o.push.apply(o,p),e.push(1*Math.cos(n),1*Math.sin(n),-E),a.push(Math.cos(n),Math.sin(n),0),o.push.apply(o,p);return t.push({mode:r.TRIANGLE_STRIP,first:0,count:e.length/3}),{topology:t,positionBuffer:w(r,e),normalBuffer:w(r,a),colorBuffer:w(r,o)}}function y(r){for(var t=[],e=[0,0,0],a=[].concat(d),o=[0,0,1],n=[0,0],i=0,u=1,c=0;c<2*Math.PI+.001;c+=Math.PI/36,u++){var l=1*Math.cos(c),s=1*Math.sin(c);e.push(l,s,0),o.push(0,0,1),a.push.apply(a,d),n.push(l/1,s/1)}return t.push({mode:r.TRIANGLE_FAN,first:i,count:u-i}),i=u,{topology:t,positionBuffer:w(r,e),normalBuffer:w(r,o),colorBuffer:w(r,a),textureCoordBuffer:w(r,n)}}function _(r,t,e){var a=function(r,t){for(var e=[],a=[],o=[],n=0;n<1.001;n+=.033333){var i=(t+n)*Math.PI,u=1.5*(i-r),c=1+E*Math.cos(u),l=1-E*Math.cos(u);a.push(c*Math.sin(i),c*Math.cos(i),-E*Math.sin(u)),a.push(l*Math.sin(i),l*Math.cos(i),.1*Math.sin(u));for(var s=[0,0,0],f=0;f<3;f++)s[f]=(1-n)*T[t][f]+n*T[(t+1)%T.length][f];o.push.apply(o,s.concat(s)),e.push(n,0,n,1)}return{positions:a,colors:o,textureCoords:e}}(t,e),o=a.positions,n=a.colors,i=a.textureCoords;return{vertexCount:o.length/3,positions:w(r,o),colors:w(r,n),textureCoords:w(r,i)}}function w(r,t){var e=r.createBuffer();if(!e)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,e),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW),e}function I(r,t,e,a,o){r.bindBuffer(r.ARRAY_BUFFER,e),r.vertexAttribPointer(t,a,o,!1,0,0),r.enableVertexAttribArray(t)}function F(r,t){r.disableVertexAttribArray(t)}function L(r,t,e){var a=r.createProgram();if(!a)throw new Error("Failed to create program.");if(r.attachShader(a,B(r,r.VERTEX_SHADER,t)),r.attachShader(a,B(r,r.FRAGMENT_SHADER,e)),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS)){var o="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(a));throw r.deleteProgram(a),new Error(o)}return a}function B(r,t,e){var a=r.createShader(t);if(!a)throw new Error("Failed to create shader.");if(r.shaderSource(a,e),r.compileShader(a),!r.getShaderParameter(a,r.COMPILE_STATUS)){var o="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(a));throw r.deleteShader(a),new Error(o)}return a}function U(r,t,e){return r.getUniformLocation(t,e)||function(r){throw new Error(r)}('No uniform named "'.concat(e,'" was found.'))}e(22);s.a.render(c.a.createElement(A,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.0fdb28b9.chunk.js.map