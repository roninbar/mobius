(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{16:function(r,t,e){r.exports=e(23)},21:function(r,t,e){},22:function(r,t,e){},23:function(r,t,e){"use strict";e.r(t);var o,a,n,i,u=e(1),c=e.n(u),s=e(6),l=e.n(s),f=e(2),h=e(7),m=e(4),v=e(0),p=(e(21),String.raw),M=[1,.8,.5],d=[.75,.75,.75],T=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]],g=.1,x=Math.PI/36;function E(){var r=Object(u.useState)(0),t=Object(m.a)(r,2),e=t[0],s=t[1],l=Object(u.useState)(),h=Object(m.a)(l,2),T=h[0],E=h[1],P=Object(u.useState)(v.a.create()),B=Object(m.a)(P,2),U=B[0],O=B[1],N=Object(u.useRef)(null),S=Object(u.useRef)(null),j=Object(u.useRef)(null);Object(u.useEffect)((function(){var r,t=null===(r=j.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");N.current=function(r){var t=p(n||(n=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    attribute vec2 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * "," * ",";\n      "," = ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","aTextureCoords","uModelMatrix","uViewMatrix","uProjectionMatrix","vColor","vTextureCoords","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition","vColor","aColor","vTextureCoords","aTextureCoords"),e=p(i||(i=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Uniforms\n    uniform sampler2D ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * texture2D(",", ",");\n    }\n  "])),"vColor","vTextureCoords","uSampler","vColor","uSampler","vTextureCoords"),o=w(r,t,e);return{program:o,attribs:{position:r.getAttribLocation(o,"aPosition"),color:r.getAttribLocation(o,"aColor"),textureCoords:r.getAttribLocation(o,"aTextureCoords")},uniforms:{sampler:F(r,o,"uSampler"),modelMatrix:F(r,o,"uModelMatrix"),viewMatrix:F(r,o,"uViewMatrix"),projectionMatrix:F(r,o,"uProjectionMatrix")}}}(t),S.current=function(r){var t=p(o||(o=Object(f.a)(["\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Attributes\n    attribute vec4 ",";\n    attribute vec3 ",";\n    attribute vec4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying lowp vec3 ",";\n    // Program\n    void main(void) {\n      // Apply lighting\n      highp vec3 ambientLightColor = vec3(0.3, 0.3, 0.3);\n      highp vec3 directionalLightColor = vec3(1, 1, 1);\n      highp vec3 directionalLightVector = normalize(vec3(0.85, 0.8, 0.75));\n      highp vec4 transformedNormal = normalize("," * "," * vec4(",", 0));\n      highp float directionalLightIntensity = max(0.0, dot(directionalLightVector, transformedNormal.xyz));\n      "," = ambientLightColor + directionalLightIntensity * directionalLightColor;\n      "," = ",";\n      gl_Position = "," * "," * "," * ",";\n    }\n  "])),"uModelMatrix","uViewMatrix","uProjectionMatrix","aPosition","aNormal","aColor","vColor","vLighting","uViewMatrix","uModelMatrix","aNormal","vLighting","vColor","aColor","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition"),e=p(a||(a=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying lowp vec3 ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * vec4(",", 1.0);\n    }\n  "])),"vColor","vLighting","vColor","vLighting"),n=w(r,t,e);return{program:n,attribs:{position:r.getAttribLocation(n,"aPosition"),normal:r.getAttribLocation(n,"aNormal"),color:r.getAttribLocation(n,"aColor")},uniforms:{modelMatrix:F(r,n,"uModelMatrix"),viewMatrix:F(r,n,"uViewMatrix"),projectionMatrix:F(r,n,"uProjectionMatrix")}}}(t);for(var e=0,u=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3];e<u.length;e++){var c=u[e];A(t,c,"".concat("/mobius","/texture/hours").concat(c-t.TEXTURE0,".bmp"))}t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.clearColor(0,0,0,1),t.enable(t.CULL_FACE),t.cullFace(t.BACK);var l=requestAnimationFrame((function r(t){s(t/12e3*Math.PI),l=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(l)}}),[]),Object(u.useEffect)((function(){var r,t=null===(r=j.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");if(!N.current||!S.current)throw new Error("Missing shader program!");var o=N.current,a=o.program,n=o.attribs,i=o.uniforms,u=S.current,c=u.program,s=u.attribs,l=u.uniforms,f=v.a.perspective(v.a.create(),Math.PI/5,t.canvas.width/t.canvas.height,.1,100),h=v.a.fromTranslation(v.a.create(),[0,0,-4]),m=function(r,e){var o=r(t),a=o.topology,n=o.positionBuffer,i=o.normalBuffer,u=o.colorBuffer;try{t.useProgram(c),t.cullFace(e),I(t,a,s.position,n,s.normal,i,s.color,u)}finally{t.deleteBuffer(u),t.deleteBuffer(i),t.deleteBuffer(n)}};t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.uniformMatrix4fv(l.modelMatrix,!1,v.a.scale(v.a.create(),U,[1.2,1.2,1])),t.uniformMatrix4fv(l.viewMatrix,!1,h),t.uniformMatrix4fv(l.projectionMatrix,!1,f);var p=function(r){for(var t=[],e=[],o=[],a=[],n=0;n<2*Math.PI+.001;n+=x)e.push(1*Math.cos(n),1*Math.sin(n),.1),o.push(Math.cos(n),Math.sin(n),0),a.push.apply(a,M),e.push(1*Math.cos(n),1*Math.sin(n),-g),o.push(Math.cos(n),Math.sin(n),0),a.push.apply(a,M);return t.push({mode:r.TRIANGLE_STRIP,first:0,count:e.length/3}),{topology:t,positionBuffer:L(r,e),normalBuffer:L(r,o),colorBuffer:L(r,a)}}(t),T=p.topology,E=p.positionBuffer,A=p.normalBuffer,P=p.colorBuffer;try{t.useProgram(c),t.cullFace(t.FRONT),I(t,T,s.position,E,s.normal,A,s.color,P)}finally{t.deleteBuffer(P),t.deleteBuffer(A),t.deleteBuffer(P)}t.uniformMatrix4fv(l.modelMatrix,!1,v.a.translate(v.a.create(),U,[0,0,-.2])),m(b,t.BACK);for(var w=[],B=[],F=[],O=[],D=0;D<4;D++){var X=y(t,e,D);w[D]=X.vertexCount,B[D]=X.positions,F[D]=X.colors,O[D]=X.textureCoords}try{t.useProgram(a),t.uniformMatrix4fv(N.current.uniforms.modelMatrix,!1,U),t.uniformMatrix4fv(N.current.uniforms.viewMatrix,!1,h),t.uniformMatrix4fv(N.current.uniforms.projectionMatrix,!1,f);for(var G=0;G<4;G++){t.uniform1i(i.sampler,G),C(t,n.position,B[G],3,t.FLOAT),C(t,n.color,F[G],3,t.FLOAT),C(t,n.textureCoords,O[G],2,t.FLOAT);try{t.cullFace(t.BACK),t.drawArrays(t.TRIANGLE_STRIP,0,w[G])}finally{_(t,n.textureCoords),_(t,n.color),_(t,n.position)}}}finally{[].concat(B,F,O).forEach((function(r){return t.deleteBuffer(r)}))}var V=function(r,e,o,a){var n=function(r,t,e,o){return{vertexCount:4,positions:L(r,[-e,-.2*o,t,+e,-.2*o,t,-e,o,t,+e,o,t]),normals:L(r,[0,0,1,0,0,1,0,0,1,0,0,1]),colors:L(r,[].concat(d,d,d,d))}}(t,r,e,o),i=n.vertexCount,u=n.positions,m=n.normals,p=n.colors;try{t.useProgram(c),t.uniformMatrix4fv(l.modelMatrix,!1,v.a.rotateZ(v.a.create(),U,-a)),t.uniformMatrix4fv(l.viewMatrix,!1,h),t.uniformMatrix4fv(l.projectionMatrix,!1,f),C(t,s.position,u,3,t.FLOAT),C(t,s.normal,m,3,t.FLOAT),C(t,s.color,p,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_STRIP,0,i)}finally{_(t,s.color),_(t,s.normal),_(t,s.position)}}finally{t.deleteBuffer(p),t.deleteBuffer(m),t.deleteBuffer(u)}};V(.01,.02,.6,e),V(.02,.02,.8,12*e);var Y=function(r,t){for(var e=.05,o=.01,a=Math.sqrt(e*e+o*o),n=e/a,i=o/a,u=[0,0,t+o],c=[0,0,1],s=[].concat(d),l=0;l<2*Math.PI;l+=Math.PI/30)u.push(e*Math.cos(l),e*Math.sin(l),t),c.push(i*Math.cos(l),i*Math.sin(l),n),s.push.apply(s,d);return{vertexCount:u.length/3,positions:L(r,u),normals:L(r,c),colors:L(r,s)}}(t,.03),K=Y.vertexCount,W=Y.positions,k=Y.normals,q=Y.colors;try{t.useProgram(c),t.uniformMatrix4fv(l.modelMatrix,!1,U),t.uniformMatrix4fv(l.viewMatrix,!1,h),t.uniformMatrix4fv(l.projectionMatrix,!1,f),C(t,s.position,W,3,t.FLOAT),C(t,s.normal,k,3,t.FLOAT),C(t,s.color,q,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_FAN,0,K)}finally{_(t,s.position),_(t,s.color)}}finally{t.deleteBuffer(q),t.deleteBuffer(W)}var z=v.a.copy(v.a.create(),U);v.a.translate(z,z,[0,0,-g]),v.a.rotateY(z,z,Math.PI),v.a.scale(z,z,[1.2,1.2,.24]),t.uniformMatrix4fv(l.modelMatrix,!1,z),m(R,t.BACK)}),[e,U]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("canvas",{width:"768px",height:"768px",ref:j,onPointerDown:function(r){var t=r.currentTarget,e=r.pointerId,o=r.clientX,a=r.clientY;t.setPointerCapture(e),E({x:o,y:a})},onPointerMove:function(r){var t=r.clientX,e=r.clientY;if(T){var o=t-T.x,a=e-T.y,n=Math.sqrt(o*o+a*a);if(n>0){var i=v.a.fromRotation(v.a.create(),.01*n,[a,o,0]);O(v.a.mul(v.a.create(),i,U)),E({x:t,y:e})}}},onPointerUp:function(r){var t=r.currentTarget,e=r.pointerId;E(null),t.releasePointerCapture(e)}}),c.a.createElement("p",null,"M\xf6bius Clock")))}function A(r,t,e){var o=r.createTexture();r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));var a=new Image;return a.onload=function(){r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,a),P(a.width)&&P(a.height)?(r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},a.src=e,o}function P(r){return 0===(r&r-1)}function R(r){for(var t=[],e=[0,0,1],o=[0,0,1],a=[].concat(M),n=0,i=1,u=1*Math.sin(x),c=1*Math.cos(x),s=-Math.PI;s<Math.PI+.001;s+=x,i++){var l=u*Math.cos(s),f=u*Math.sin(s);e.push(l,f,c),o.push(l,f,c),a.push.apply(a,M)}t.push({mode:r.TRIANGLE_FAN,first:n,count:i-n}),n=i;for(var h=x;h<.5*Math.PI-.001;h+=x){for(var m=1*Math.sin(h),v=1*Math.sin(h+x),p=1*Math.cos(h),d=1*Math.cos(h+x),T=-Math.PI;T<Math.PI+.001;T+=x,i+=2){var g=m*Math.cos(T),E=v*Math.cos(T),A=m*Math.sin(T),P=v*Math.sin(T);e.push(g,A,p),o.push(g,A,p),a.push.apply(a,M),e.push(E,P,d),o.push(E,P,d),a.push.apply(a,M)}t.push({mode:r.TRIANGLE_STRIP,first:n,count:i-n}),n=i}return{topology:t,positionBuffer:L(r,e),normalBuffer:L(r,o),colorBuffer:L(r,a)}}function b(r){for(var t=[],e=[0,0,0],o=[.25,.25,.25],a=[0,0,1],n=[0,0],i=0,u=1,c=0;c<2*Math.PI+.001;c+=Math.PI/36,u++){var s=1/6*Math.cos(c),l=1/6*Math.sin(c);e.push(s,l,0),a.push(0,0,1),o.push(o[0],o[1],o[2]),n.push(s/1,l/1)}t.push({mode:r.TRIANGLE_FAN,first:i,count:u-i}),i=u;for(var f=1/6;f<.999;f+=1/6){for(var h=0;h<2*Math.PI+.001;h+=Math.PI/36,u+=2){var m=f*Math.cos(h),v=f*Math.sin(h);e.push(m,v,0),a.push(0,0,1),o.push(o[0],o[1],o[2]),n.push(m/1,v/1);var p=(f+1/6)*Math.cos(h),M=(f+1/6)*Math.sin(h);e.push(p,M,0),a.push(0,0,1),o.push(o[0],o[1],o[2]),n.push(p/1,M/1)}t.push({mode:r.TRIANGLE_STRIP,first:i,count:u-i}),i=u}return{topology:t,positionBuffer:L(r,e),normalBuffer:L(r,a),colorBuffer:L(r,o),textureCoordBuffer:L(r,n)}}function y(r,t,e){var o=function(r,t){for(var e=[],o=[],a=[],n=0;n<1.001;n+=.033333){var i=(t+n)*Math.PI,u=1.5*(i-r),c=1+g*Math.cos(u),s=1-g*Math.cos(u);o.push(c*Math.sin(i),c*Math.cos(i),-g*Math.sin(u)),o.push(s*Math.sin(i),s*Math.cos(i),.1*Math.sin(u));for(var l=[0,0,0],f=0;f<3;f++)l[f]=(1-n)*T[t][f]+n*T[(t+1)%T.length][f];a.push.apply(a,l.concat(l)),e.push(n,0,n,1)}return{positions:o,colors:a,textureCoords:e}}(t,e),a=o.positions,n=o.colors,i=o.textureCoords;return{vertexCount:a.length/3,positions:L(r,a),colors:L(r,n),textureCoords:L(r,i)}}function L(r,t){var e=r.createBuffer();if(!e)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,e),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW),e}function I(r,t,e,o,a,n,i,u){C(r,e,o,3,r.FLOAT),C(r,a,n,3,r.FLOAT),C(r,i,u,3,r.FLOAT);try{var c,s=Object(h.a)(t);try{for(s.s();!(c=s.n()).done;){var l=c.value,f=l.mode,m=l.first,v=l.count;r.drawArrays(f,m,v)}}catch(p){s.e(p)}finally{s.f()}}finally{_(r,i),_(r,a),_(r,e)}}function C(r,t,e,o,a){r.bindBuffer(r.ARRAY_BUFFER,e),r.vertexAttribPointer(t,o,a,!1,0,0),r.enableVertexAttribArray(t)}function _(r,t){r.disableVertexAttribArray(t)}function w(r,t,e){var o=r.createProgram();if(!o)throw new Error("Failed to create program.");if(r.attachShader(o,B(r,r.VERTEX_SHADER,t)),r.attachShader(o,B(r,r.FRAGMENT_SHADER,e)),r.linkProgram(o),!r.getProgramParameter(o,r.LINK_STATUS)){var a="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(o));throw r.deleteProgram(o),new Error(a)}return o}function B(r,t,e){var o=r.createShader(t);if(!o)throw new Error("Failed to create shader.");if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var a="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(o));throw r.deleteShader(o),new Error(a)}return o}function F(r,t,e){return r.getUniformLocation(t,e)||function(r){throw new Error(r)}('No uniform named "'.concat(e,'" was found.'))}e(22);l.a.render(c.a.createElement(E,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.bb02a3e4.chunk.js.map