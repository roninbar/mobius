(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{16:function(r,t,a){r.exports=a(23)},21:function(r,t,a){},22:function(r,t,a){},23:function(r,t,a){"use strict";a.r(t);var e,o,n,i,u=a(1),c=a.n(u),s=a(6),l=a.n(s),f=a(2),h=a(7),m=a(4),v=a(0),p=(a(21),String.raw),M=[0,0,0],x=[1,.8,.5],d=[.75,.75,.75],T=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]],E=.1,g=Math.PI/36;function A(){var r=Object(u.useState)(0),t=Object(m.a)(r,2),a=t[0],s=t[1],l=Object(u.useState)(),M=Object(m.a)(l,2),x=M[0],T=M[1],g=Object(u.useState)(v.a.create()),A=Object(m.a)(g,2),R=A[0],B=A[1],N=v.a.copy(v.a.create(),R),O=Object(u.useRef)(null),S=Object(u.useRef)(null),D=Object(u.useRef)(null);Object(u.useEffect)((function(){var r,t=null===(r=D.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");O.current=function(r){var t=p(n||(n=Object(f.a)(["\n    // Attributes\n    attribute vec4 ",";\n    attribute vec4 ",";\n    attribute vec2 ",";\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Program\n    void main(void) {\n      gl_Position = "," * "," * "," * ",";\n      "," = ",";\n      "," = ",";\n    }\n  "])),"aPosition","aColor","aTextureCoords","uModelMatrix","uViewMatrix","uProjectionMatrix","vColor","vTextureCoords","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition","vColor","aColor","vTextureCoords","aTextureCoords"),a=p(i||(i=Object(f.a)(["\n    // Varyings\n    varying lowp vec4 ",";\n    varying highp vec2 ",";\n    // Uniforms\n    uniform sampler2D ",";\n    // Program\n    void main(void) {\n      gl_FragColor = "," * texture2D(",", ",");\n    }\n  "])),"vColor","vTextureCoords","uSampler","vColor","uSampler","vTextureCoords"),e=L(r,t,a);return{program:e,attribs:{position:r.getAttribLocation(e,"aPosition"),color:r.getAttribLocation(e,"aColor"),textureCoords:r.getAttribLocation(e,"aTextureCoords")},uniforms:{sampler:U(r,e,"uSampler"),modelMatrix:U(r,e,"uModelMatrix"),viewMatrix:U(r,e,"uViewMatrix"),projectionMatrix:U(r,e,"uProjectionMatrix")}}}(t),S.current=function(r){var t=p(e||(e=Object(f.a)(["\n    // Uniforms\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    uniform mat4 ",";\n    // Attributes\n    attribute vec4 ",";\n    attribute vec3 ",";\n    attribute vec4 ",";\n    // Varyings\n    varying highp vec4 ",";\n    varying lowp vec4 ",";\n    // Program\n    void main(void) {\n      "," = normalize("," * "," * vec4(",", 0));\n      "," = ",";\n      gl_Position = "," * "," * "," * ",";\n    }\n  "])),"uModelMatrix","uNormalMatrix","uViewMatrix","uProjectionMatrix","aPosition","aNormal","aColor","vNormal","vColor","vNormal","uViewMatrix","uNormalMatrix","aNormal","vColor","aColor","uProjectionMatrix","uViewMatrix","uModelMatrix","aPosition"),a=p(o||(o=Object(f.a)(["\n    // Varyings\n    varying highp vec4 ",";\n    varying lowp vec4 ",";\n    // Program\n    void main(void) {\n      // Apply lighting\n      lowp vec3 Ca = vec3(0.3, 0.3, 0.3); // Ambient light color\n      lowp vec3 Cd = vec3(1, 1, 1); // Diffuse light color (white)\n      highp vec3 u = normalize(vec3(0.85, 0.8, 0.75)); // Diffuse light direction\n      lowp float Id = max(0.0, (gl_FrontFacing ? +1.0 : -1.0) * dot(u, ",".xyz)); // Diffuse intensity\n      lowp vec4 C = vec4(Ca + Id * Cd, 1.0); // Total incident light color\n      gl_FragColor = "," * C;\n    }\n  "])),"vNormal","vColor","vNormal","vColor"),n=L(r,t,a);return{program:n,attribs:{position:r.getAttribLocation(n,"aPosition"),normal:r.getAttribLocation(n,"aNormal"),color:r.getAttribLocation(n,"aColor")},uniforms:{viewMatrix:U(r,n,"uViewMatrix"),modelMatrix:U(r,n,"uModelMatrix"),normalMatrix:U(r,n,"uNormalMatrix"),projectionMatrix:U(r,n,"uProjectionMatrix")}}}(t);for(var a=0,u=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3];a<u.length;a++){var c=u[a];P(t,c,"".concat("/mobius","/texture/hours").concat(c-t.TEXTURE0,".bmp"))}t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.clearColor(0,0,0,1),t.enable(t.CULL_FACE),t.cullFace(t.BACK);var l=requestAnimationFrame((function r(t){s(t/12e3*Math.PI),l=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(l)}}),[]),Object(u.useEffect)((function(){var r,t=null===(r=D.current)||void 0===r?void 0:r.getContext("webgl");if(!t)throw new Error("Failed to get a WebGL context.");if(!O.current||!S.current)throw new Error("Missing shader program!");var e=O.current,o=e.program,n=e.attribs,i=e.uniforms,u=S.current,c=u.program,s=u.attribs,l=u.uniforms,f=v.a.perspective(v.a.create(),Math.PI/5,t.canvas.width/t.canvas.height,.1,100),m=v.a.fromTranslation(v.a.create(),[0,0,-4]);t.uniformMatrix4fv(l.viewMatrix,!1,m),t.uniformMatrix4fv(l.projectionMatrix,!1,f);var p=function(r){var a=r(t),e=a.topology,o=a.positionBuffer,n=a.normalBuffer,i=a.colorBuffer;try{t.useProgram(c),function(r,t,a,e,o,n,i,u){w(r,a,e,3,r.FLOAT),w(r,o,n,3,r.FLOAT),w(r,i,u,3,r.FLOAT);try{var c,s=Object(h.a)(t);try{for(s.s();!(c=s.n()).done;){var l=c.value,f=l.mode,m=l.first,v=l.count;r.drawArrays(f,m,v)}}catch(p){s.e(p)}finally{s.f()}}finally{F(r,i),F(r,o),F(r,a)}}(t,e,s.position,o,s.normal,n,s.color,i)}finally{t.deleteBuffer(i),t.deleteBuffer(n),t.deleteBuffer(o)}};t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.cullFace(t.FRONT),t.uniformMatrix4fv(l.modelMatrix,!1,v.a.scale(v.a.create(),R,[1.2,1.2,1])),t.uniformMatrix4fv(l.normalMatrix,!1,v.a.scale(v.a.create(),N,[1/1.2,1/1.2,1])),p(b),t.cullFace(t.BACK),t.uniformMatrix4fv(l.modelMatrix,!1,v.a.scale(v.a.create(),v.a.translate(v.a.create(),R,[0,0,-E]),[1.199,1.199,1])),p(I);for(var M=[],x=[],T=[],g=[],A=0;A<4;A++){var P=C(t,a,A);M[A]=P.vertexCount,x[A]=P.positions,T[A]=P.colors,g[A]=P.textureCoords}try{t.useProgram(o),t.uniformMatrix4fv(i.modelMatrix,!1,R),t.uniformMatrix4fv(i.viewMatrix,!1,m),t.uniformMatrix4fv(i.projectionMatrix,!1,f);for(var L=0;L<4;L++){t.uniform1i(i.sampler,L),w(t,n.position,x[L],3,t.FLOAT),w(t,n.color,T[L],3,t.FLOAT),w(t,n.textureCoords,g[L],2,t.FLOAT);try{t.cullFace(t.BACK),t.drawArrays(t.TRIANGLE_STRIP,0,M[L])}finally{F(t,n.textureCoords),F(t,n.color),F(t,n.position)}}}finally{[].concat(x,T,g).forEach((function(r){return t.deleteBuffer(r)}))}var B=function(r,a,e,o){var n=function(r,t,a,e){return{vertexCount:4,positions:_(r,[-a,-.2*e,t,+a,-.2*e,t,-a,e,t,+a,e,t]),normals:_(r,[0,0,1,0,0,1,0,0,1,0,0,1]),colors:_(r,[].concat(d,d,d,d))}}(t,r,a,e),i=n.vertexCount,u=n.positions,h=n.normals,p=n.colors;try{t.useProgram(c),t.uniformMatrix4fv(l.modelMatrix,!1,v.a.rotateZ(v.a.create(),R,-o)),t.uniformMatrix4fv(l.viewMatrix,!1,m),t.uniformMatrix4fv(l.projectionMatrix,!1,f),w(t,s.position,u,3,t.FLOAT),w(t,s.normal,h,3,t.FLOAT),w(t,s.color,p,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_STRIP,0,i)}finally{F(t,s.color),F(t,s.normal),F(t,s.position)}}finally{t.deleteBuffer(p),t.deleteBuffer(h),t.deleteBuffer(u)}};B(.01,.02,.6,a),B(.02,.02,.8,12*a);var U=function(r,t){for(var a=.05,e=.01,o=Math.sqrt(a*a+e*e),n=a/o,i=e/o,u=[0,0,t+e],c=[0,0,1],s=[].concat(d),l=0;l<2*Math.PI;l+=Math.PI/30)u.push(a*Math.cos(l),a*Math.sin(l),t),c.push(i*Math.cos(l),i*Math.sin(l),n),s.push.apply(s,d);return{vertexCount:u.length/3,positions:_(r,u),normals:_(r,c),colors:_(r,s)}}(t,.03),j=U.vertexCount,X=U.positions,G=U.normals,V=U.colors;try{t.useProgram(c),t.uniformMatrix4fv(l.modelMatrix,!1,R),t.uniformMatrix4fv(l.viewMatrix,!1,m),t.uniformMatrix4fv(l.projectionMatrix,!1,f),w(t,s.position,X,3,t.FLOAT),w(t,s.normal,G,3,t.FLOAT),w(t,s.color,V,3,t.FLOAT);try{t.drawArrays(t.TRIANGLE_FAN,0,j)}finally{F(t,s.position),F(t,s.color)}}finally{t.deleteBuffer(V),t.deleteBuffer(X)}var Y=v.a.copy(v.a.create(),R),W=v.a.copy(v.a.create(),N);v.a.translate(Y,Y,[0,0,-E]),v.a.rotateY(Y,Y,Math.PI),v.a.rotateY(W,W,Math.PI),v.a.scale(Y,Y,[1.2,1.2,.24]),v.a.scale(W,W,[1/1.2,1/1.2,1/.24]),t.uniformMatrix4fv(l.modelMatrix,!1,Y),t.uniformMatrix4fv(l.normalMatrix,!1,W),p(y),t.uniformMatrix4fv(l.modelMatrix,!1,v.a.scale(v.a.create(),R,[1.2,1.2,1])),t.uniformMatrix4fv(l.normalMatrix,!1,v.a.scale(v.a.create(),N,[1/1.2,1/1.2,1])),p(b)}),[a,R,N]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App-header"},c.a.createElement("canvas",{width:"768px",height:"768px",ref:D,onPointerDown:function(r){var t=r.currentTarget,a=r.pointerId,e=r.clientX,o=r.clientY;t.setPointerCapture(a),T({x:e,y:o})},onPointerMove:function(r){var t=r.clientX,a=r.clientY;if(x){var e=t-x.x,o=a-x.y,n=Math.sqrt(e*e+o*o);if(n>0){var i=v.a.fromRotation(v.a.create(),.01*n,[o,e,0]);B(v.a.mul(v.a.create(),i,R)),T({x:t,y:a})}}},onPointerUp:function(r){var t=r.currentTarget,a=r.pointerId;T(null),t.releasePointerCapture(a)}}),c.a.createElement("p",null,"M\xf6bius Clock")))}function P(r,t,a){var e=r.createTexture();r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));var o=new Image;return o.onload=function(){r.activeTexture(t),r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,o),R(o.width)&&R(o.height)?(r.generateMipmap(r.TEXTURE_2D),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},o.src=a,e}function R(r){return 0===(r&r-1)}function y(r){for(var t=[],a=[0,0,1],e=[0,0,1],o=[].concat(x),n=0,i=1,u=1*Math.sin(g),c=1*Math.cos(g),s=-Math.PI;s<Math.PI+.001;s+=g,i++){var l=u*Math.cos(s),f=u*Math.sin(s);a.push(l,f,c),e.push(l,f,c),o.push.apply(o,x)}t.push({mode:r.TRIANGLE_FAN,first:n,count:i-n}),n=i;for(var h=g;h<.5*Math.PI-.001;h+=g){for(var m=1*Math.sin(h),v=1*Math.sin(h+g),p=1*Math.cos(h),M=1*Math.cos(h+g),d=-Math.PI;d<Math.PI+.001;d+=g,i+=2){var T=m*Math.cos(d),E=v*Math.cos(d),A=m*Math.sin(d),P=v*Math.sin(d);a.push(T,A,p),e.push(T,A,p),o.push.apply(o,x),a.push(E,P,M),e.push(E,P,M),o.push.apply(o,x)}t.push({mode:r.TRIANGLE_STRIP,first:n,count:i-n}),n=i}return{topology:t,positionBuffer:_(r,a),normalBuffer:_(r,e),colorBuffer:_(r,o)}}function b(r){for(var t=[],a=[],e=[],o=[],n=0;n<2*Math.PI+.001;n+=g)a.push(1*Math.cos(n),1*Math.sin(n),.1),e.push(Math.cos(n),Math.sin(n),0),o.push.apply(o,x),a.push(1*Math.cos(n),1*Math.sin(n),-E),e.push(Math.cos(n),Math.sin(n),0),o.push.apply(o,x);return t.push({mode:r.TRIANGLE_STRIP,first:0,count:a.length/3}),{topology:t,positionBuffer:_(r,a),normalBuffer:_(r,e),colorBuffer:_(r,o)}}function I(r){for(var t=[],a=[0,0,0],e=[].concat(M),o=[0,0,1],n=[0,0],i=0,u=1,c=0;c<2*Math.PI+.001;c+=Math.PI/36,u++){var s=1/6*Math.cos(c),l=1/6*Math.sin(c);a.push(s,l,0),o.push(0,0,1),e.push.apply(e,M),n.push(s/1,l/1)}t.push({mode:r.TRIANGLE_FAN,first:i,count:u-i}),i=u;for(var f=1/6;f<.999;f+=1/6){for(var h=0;h<2*Math.PI+.001;h+=Math.PI/36,u+=2){var m=f*Math.cos(h),v=f*Math.sin(h);a.push(m,v,0),o.push(0,0,1),e.push.apply(e,M),n.push(m/1,v/1);var p=(f+1/6)*Math.cos(h),x=(f+1/6)*Math.sin(h);a.push(p,x,0),o.push(0,0,1),e.push.apply(e,M),n.push(p/1,x/1)}t.push({mode:r.TRIANGLE_STRIP,first:i,count:u-i}),i=u}return{topology:t,positionBuffer:_(r,a),normalBuffer:_(r,o),colorBuffer:_(r,e),textureCoordBuffer:_(r,n)}}function C(r,t,a){var e=function(r,t){for(var a=[],e=[],o=[],n=0;n<1.001;n+=.033333){var i=(t+n)*Math.PI,u=1.5*(i-r),c=1+E*Math.cos(u),s=1-E*Math.cos(u);e.push(c*Math.sin(i),c*Math.cos(i),-E*Math.sin(u)),e.push(s*Math.sin(i),s*Math.cos(i),.1*Math.sin(u));for(var l=[0,0,0],f=0;f<3;f++)l[f]=(1-n)*T[t][f]+n*T[(t+1)%T.length][f];o.push.apply(o,l.concat(l)),a.push(n,0,n,1)}return{positions:e,colors:o,textureCoords:a}}(t,a),o=e.positions,n=e.colors,i=e.textureCoords;return{vertexCount:o.length/3,positions:_(r,o),colors:_(r,n),textureCoords:_(r,i)}}function _(r,t){var a=r.createBuffer();if(!a)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW),a}function w(r,t,a,e,o){r.bindBuffer(r.ARRAY_BUFFER,a),r.vertexAttribPointer(t,e,o,!1,0,0),r.enableVertexAttribArray(t)}function F(r,t){r.disableVertexAttribArray(t)}function L(r,t,a){var e=r.createProgram();if(!e)throw new Error("Failed to create program.");if(r.attachShader(e,B(r,r.VERTEX_SHADER,t)),r.attachShader(e,B(r,r.FRAGMENT_SHADER,a)),r.linkProgram(e),!r.getProgramParameter(e,r.LINK_STATUS)){var o="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(e));throw r.deleteProgram(e),new Error(o)}return e}function B(r,t,a){var e=r.createShader(t);if(!e)throw new Error("Failed to create shader.");if(r.shaderSource(e,a),r.compileShader(e),!r.getShaderParameter(e,r.COMPILE_STATUS)){var o="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(e));throw r.deleteShader(e),new Error(o)}return e}function U(r,t,a){return r.getUniformLocation(t,a)||function(r){throw new Error(r)}('No uniform named "'.concat(a,'" was found.'))}a(22);l.a.render(c.a.createElement(A,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.1c934d51.chunk.js.map