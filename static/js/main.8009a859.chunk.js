(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{17:function(r,e,t){r.exports=t(24)},22:function(r,e,t){},23:function(r,e,t){},24:function(r,e,t){"use strict";t.r(e);var o,n,a=t(0),i=t.n(a),c=t(8),u=t.n(c),s=t(4),E=t(5),l=t(6),T=t(2),f=(t(22),function(r){return Object(l.a)(r,1)[0]}),m=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]];function d(){var r=Object(a.useState)(0),e=Object(l.a)(r,2),t=e[0],c=e[1],u=Object(a.useRef)(null),E=Object(a.useRef)(null);return Object(a.useEffect)((function(){var r,e=null===(r=E.current)||void 0===r?void 0:r.getContext("webgl");if(!e)throw new Error("Failed to get a WebGL context.");u.current=function(r){var e=f(o||(o=Object(s.a)(["\n    // Attributes\n    attribute vec4 aPosition;\n    attribute vec4 aColor;\n    attribute vec2 aTextureCoords;\n    // Uniforms\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n    // Varyings\n    varying lowp vec4 vColor;\n    varying highp vec2 vTextureCoords;\n    // Program\n    void main(void) {\n      gl_Position = uProjectionMatrix * uModelViewMatrix * aPosition;\n      vColor = aColor;\n      vTextureCoords = aTextureCoords;\n    }\n  "]))),t=f(n||(n=Object(s.a)(["\n    // Varyings\n    varying lowp vec4 vColor;\n    varying highp vec2 vTextureCoords;\n    // Uniforms\n    uniform sampler2D uSampler;\n    // Program\n    void main(void) {\n      gl_FragColor = vColor * texture2D(uSampler, vTextureCoords);\n    }\n  "]))),a=r.createProgram();if(!a)throw new Error("Failed to create program.");if(r.attachShader(a,_(r,r.VERTEX_SHADER,e)),r.attachShader(a,_(r,r.FRAGMENT_SHADER,t)),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS)){var i="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(a));throw r.deleteProgram(a),new Error(i)}return{program:a,attribs:{position:r.getAttribLocation(a,"aPosition"),color:r.getAttribLocation(a,"aColor"),textureCoords:r.getAttribLocation(a,"aTextureCoords")},uniforms:{sampler:A(r,a,"uSampler"),modelViewMatrix:A(r,a,"uModelViewMatrix"),projectionMatrix:A(r,a,"uProjectionMatrix")}}}(e),e.useProgram(u.current.program),e.uniformMatrix4fv(u.current.uniforms.modelViewMatrix,!1,function(r){var e=T.a.create();return T.a.translate(e,e,[0,0,-r]),e}(4)),e.uniformMatrix4fv(u.current.uniforms.projectionMatrix,!1,function(r,e,t,o,n){var a=T.a.create();return T.a.perspective(a,t,r/e,o,n),a}(e.canvas.width,e.canvas.height,Math.PI/5,.1,100));for(var t=0,a=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3];t<a.length;t++){var i=a[t],l=v(e,"".concat("/mobius","/texture/hours").concat(i-e.TEXTURE0,".bmp"));e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)}e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearDepth(1),e.clearColor(0,0,0,1),e.enable(e.CULL_FACE);var m=requestAnimationFrame((function r(e){c(e/4e3*Math.PI),m=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(m)}}),[]),Object(a.useEffect)((function(){var r,e=null===(r=E.current)||void 0===r?void 0:r.getContext("webgl");if(!e)throw new Error("Failed to get a WebGL context.");var o=g(e,t,0),n=o.positions,a=o.colors,i=o.textureCoords,c=o.count,s=g(e,t,2),l=s.positions,T=s.colors,f=s.textureCoords,m=s.count;if(!u.current)throw new Error("No shader program!");var d=u.current.attribs;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.cullFace(e.BACK),e.uniform1i(u.current.uniforms.sampler,0),h(e,d.position,d.color,d.textureCoords,n,a,i,c/3),e.cullFace(e.FRONT),e.uniform1i(u.current.uniforms.sampler,2),h(e,d.position,d.color,d.textureCoords,l,T,f,m/3)}),[t]),i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement("canvas",{width:"640px",height:"640px",ref:E}),i.a.createElement("p",null,"M\xf6bius Clock")))}function h(r,e,t,o,n,a,i,c){R(r,e,n,3,r.FLOAT),R(r,t,a,3,r.FLOAT),R(r,o,i,2,r.FLOAT),r.drawArrays(r.TRIANGLE_STRIP,0,c)}function v(r,e){var t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);var o=r.RGBA,n=r.RGBA,a=r.UNSIGNED_BYTE,i=new Uint8Array([0,0,255,255]);r.texImage2D(r.TEXTURE_2D,0,o,1,1,0,n,a,i);var c=new Image;return c.onload=function(){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,o,n,a,c),p(c.width)&&p(c.height)?r.generateMipmap(r.TEXTURE_2D):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},c.src=e,t}function p(r){return 0===(r&r-1)}function R(r,e,t,o,n){r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(e,o,n,!1,0,0),r.enableVertexAttribArray(e)}function g(r,e,t){var o=function(r,e){for(var t=[],o=[],n=[],a=.1,i=0;i<2;i++)for(var c=0;c<1.001;c+=.033333){var u=(i+c)*Math.PI,s=1.5*u-r,l=1-a*Math.cos(s),T=1+a*Math.cos(s);o.push(l*Math.sin(u),l*Math.cos(u),-a*Math.sin(s)),o.push(T*Math.sin(u),T*Math.cos(u),.1*Math.sin(s));for(var f=new Array(3).fill(0),d=0;d<3;d++)f[d]=(1-c)*m[e+i][d]+c*m[(e+i+1)%m.length][d];n.push.apply(n,Object(E.a)(f).concat(Object(E.a)(f))),t.push(u/Math.PI,1,u/Math.PI,0)}return{positions:o,colors:n,textureCoords:t}}(e,t),n=o.positions,a=o.colors,i=o.textureCoords;return{positions:x(r,n),colors:x(r,a),textureCoords:x(r,i),count:n.length}}function x(r,e){var t=r.createBuffer();if(!t)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e),r.STATIC_DRAW),t}function A(r,e,t){return r.getUniformLocation(e,t)||function(r){throw new Error(r)}('No uniform named "'.concat(t,'" was found.'))}function _(r,e,t){var o=r.createShader(e);if(!o)throw new Error("Failed to create shader.");if(r.shaderSource(o,t),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var n="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(o));throw r.deleteShader(o),new Error(n)}return o}t(23);u.a.render(i.a.createElement(d,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.8009a859.chunk.js.map