(this.webpackJsonpmobius=this.webpackJsonpmobius||[]).push([[0],{14:function(r,e,t){r.exports=t(21)},19:function(r,e,t){},20:function(r,e,t){},21:function(r,e,t){"use strict";t.r(e);var o,n,a=t(0),i=t.n(a),u=t(5),c=t.n(u),s=t(3),E=t(2),l=t(1),T=(t(19),function(r){return Object(E.a)(r,1)[0]}),f=[[0,0,1],[0,1,0],[1,1,0],[1,0,0]];function m(){var r=Object(a.useState)(0),e=Object(E.a)(r,2),t=e[0],u=e[1],c=Object(a.useState)(0),f=Object(E.a)(c,2),m=f[0],v=f[1],p=Object(a.useRef)(null),R=Object(a.useRef)(null);return Object(a.useEffect)((function(){var r,e=null===(r=R.current)||void 0===r?void 0:r.getContext("webgl");if(!e)throw new Error("Failed to get a WebGL context.");p.current=function(r){var e=T(o||(o=Object(s.a)(["\n    // Attributes\n    attribute vec4 aPosition;\n    attribute vec4 aColor;\n    attribute vec2 aTextureCoords;\n    // Uniforms\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n    // Varyings\n    varying lowp vec4 vColor;\n    varying highp vec2 vTextureCoords;\n    // Program\n    void main(void) {\n      gl_Position = uProjectionMatrix * uModelViewMatrix * aPosition;\n      vColor = aColor;\n      vTextureCoords = aTextureCoords;\n    }\n  "]))),t=T(n||(n=Object(s.a)(["\n    // Varyings\n    varying lowp vec4 vColor;\n    varying highp vec2 vTextureCoords;\n    // Uniforms\n    uniform sampler2D uSampler;\n    // Program\n    void main(void) {\n      gl_FragColor = vColor * texture2D(uSampler, vTextureCoords);\n    }\n  "]))),a=r.createProgram();if(!a)throw new Error("Failed to create program.");if(r.attachShader(a,A(r,r.VERTEX_SHADER,e)),r.attachShader(a,A(r,r.FRAGMENT_SHADER,t)),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS)){var i="Unable to initialize the shader program: ".concat(r.getProgramInfoLog(a));throw r.deleteProgram(a),new Error(i)}return{program:a,attribs:{position:r.getAttribLocation(a,"aPosition"),color:r.getAttribLocation(a,"aColor"),textureCoords:r.getAttribLocation(a,"aTextureCoords")},uniforms:{sampler:x(r,a,"uSampler"),modelViewMatrix:x(r,a,"uModelViewMatrix"),projectionMatrix:x(r,a,"uProjectionMatrix")}}}(e),e.useProgram(p.current.program),e.uniformMatrix4fv(p.current.uniforms.modelViewMatrix,!1,function(r){var e=l.a.create();return l.a.translate(e,e,[0,0,-r]),e}(4)),e.uniformMatrix4fv(p.current.uniforms.projectionMatrix,!1,function(r,e,t,o,n){var a=l.a.create();return l.a.perspective(a,t,r/e,o,n),a}(e.canvas.width,e.canvas.height,Math.PI/5,.1,100));for(var t=0,a=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3];t<a.length;t++){var i=a[t],u=h(e,"".concat("/mobius","/texture/hours").concat(i-e.TEXTURE0,".bmp"));e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR)}e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clearDepth(1),e.clearColor(0,0,0,1),e.enable(e.CULL_FACE),e.cullFace(e.BACK);var c=requestAnimationFrame((function r(e){v(e/4e3*Math.PI),c=requestAnimationFrame(r)}));return function(){cancelAnimationFrame(c)}}),[]),Object(a.useEffect)((function(){var r,e=null===(r=R.current)||void 0===r?void 0:r.getContext("webgl");if(!e)throw new Error("Failed to get a WebGL context.");if(!p.current)throw new Error("No shader program!");for(var t=p.current,o=t.attribs,n=t.uniforms,a=[],i=[],u=[],c=[],s=0;s<4;s++){var E=g(e,m,s);a[s]=E.vertexCount,i[s]=E.positions,u[s]=E.colors,c[s]=E.textureCoords}try{e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);for(var l=0;l<4;l++)e.uniform1i(n.sampler,l),d(e,62,o.position,i[l],o.color,u[l],o.textureCoords,c[l])}finally{[].concat(i,u,c).forEach((function(r){return e.deleteBuffer(r)}))}}),[t,m]),i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement("input",{type:"number",name:"piece",value:t,onInput:function(r){var e=r.target;return u(+e.value)}}),i.a.createElement("canvas",{width:"640px",height:"640px",ref:R}),i.a.createElement("p",null,"M\xf6bius Clock")))}function d(r,e,t,o,n,a,i,u){p(r,t,o,3,r.FLOAT),p(r,n,a,3,r.FLOAT),p(r,i,u,2,r.FLOAT),r.drawArrays(r.TRIANGLE_STRIP,0,e)}function h(r,e){var t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);var o=r.RGBA,n=r.RGBA,a=r.UNSIGNED_BYTE,i=new Uint8Array([0,0,255,255]);r.texImage2D(r.TEXTURE_2D,0,o,1,1,0,n,a,i);var u=new Image;return u.onload=function(){r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,o,n,a,u),v(u.width)&&v(u.height)?r.generateMipmap(r.TEXTURE_2D):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR))},u.src=e,t}function v(r){return 0===(r&r-1)}function p(r,e,t,o,n){r.bindBuffer(r.ARRAY_BUFFER,t),r.vertexAttribPointer(e,o,n,!1,0,0),r.enableVertexAttribArray(e)}function g(r,e,t){var o=function(r,e){for(var t=[],o=[],n=[],a=.1,i=0;i<1.001;i+=.033333){var u=(e+i)*Math.PI,c=1.5*u-r,s=1-a*Math.cos(c),E=1+a*Math.cos(c);o.push(s*Math.sin(u),s*Math.cos(u),-a*Math.sin(c)),o.push(E*Math.sin(u),E*Math.cos(u),.1*Math.sin(c));for(var l=[0,0,0],T=0;T<3;T++)l[T]=(1-i)*f[e][T]+i*f[(e+1)%f.length][T];n.push.apply(n,l.concat(l)),t.push(i,0,i,1)}return{positions:o,colors:n,textureCoords:t}}(e,t),n=o.positions,a=o.colors,i=o.textureCoords;return{vertexCount:n.length/3,positions:R(r,n),colors:R(r,a),textureCoords:R(r,i)}}function R(r,e){var t=r.createBuffer();if(!t)throw new Error("Failed to create buffer.");return r.bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,new Float32Array(e),r.STATIC_DRAW),t}function x(r,e,t){return r.getUniformLocation(e,t)||function(r){throw new Error(r)}('No uniform named "'.concat(t,'" was found.'))}function A(r,e,t){var o=r.createShader(e);if(!o)throw new Error("Failed to create shader.");if(r.shaderSource(o,t),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){var n="An error occurred compiling the shaders: ".concat(r.getShaderInfoLog(o));throw r.deleteShader(o),new Error(n)}return o}t(20);c.a.render(i.a.createElement(m,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.b8a3622b.chunk.js.map